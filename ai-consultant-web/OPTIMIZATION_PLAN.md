# 咨询平台智能体体验优化方案

## 一、当前问题汇总 (Current Issues)

### 1. 信息展示层
- **JSON 数据泄漏**：AI 在回复中包含的结构化数据（如 `{"product": "..."}`）直接暴露在对话气泡中，严重干扰用户阅读。
- **对话区域狭窄**：左侧对话框宽度仅占 35% (max 450px)，导致长文本、列表显示拥挤，阅读体验不佳。
- **内容遮挡**：底部输入框区域高度固定，容易遮挡最后一条对话消息。

### 2. 交互逻辑层
- **重置功能不彻底**：点击“重置”按钮仅清空了聊天记录，右侧画布（Canvas）数据和后台会话 ID（Session ID）依然保留。用户无法真正开始一次“全新的”咨询，导致旧数据干扰新对话。
- **状态同步缺失**：左侧重置后，右侧内容未同步清空，造成界面状态不一致。

---

## 二、产品经理视角的深度优化建议 (PM Insights)

作为 Agent 产品经理，除了修复上述 Bug，我们还应关注以下体验提升点：

### 1. 沉浸式阅读体验
- **黄金比例布局**：建议将对话区域宽度提升至 **45%**（或固定最大宽度 600px-800px），更符合人类阅读长文的习惯。
- **智能过滤**：后端或前端必须有一层“清洗”机制，确保用户只看到自然语言，而将数据更新悄无声息地同步到右侧。

### 2. 明确的会话生命周期
- **“新会话”心智**：用户点击重置时的心理预期是“从头开始”。系统必须彻底清除所有上下文记忆（Memory）和画布状态（State），给用户一张白纸。
- **反馈机制**：重置成功后，应给予轻量级反馈（如 Toast 提示“已开启新会话”），让用户有掌控感。

### 3. 视觉与操作细节
- **底部留白**：在对话列表底部增加足够的 Padding，确保最后一条消息永远在输入框上方，而不是被遮挡。
- **空状态引导**：当右侧画布为空时，显示更直观的引导图或示例文本，告诉用户“这里将根据您的对话自动生成商业画布”。

---

## 三、本次迭代执行计划 (Implementation Plan)

基于上述分析，本次迭代将优先解决核心体验阻碍：

### Step 1: 修复数据泄漏与展示 (UI/UX)
- **目标**：净化对话界面，提升阅读舒适度。
- **行动**：
    1.  **增强 `sanitizeChatText`**：在 `ChatInterface.tsx` 中实现更激进的正则匹配，自动识别并隐藏包含 `product/target` 等字段的 JSON 文本块。
    2.  **拓宽布局**：将 `ChatInterface` 宽度调整为 `w-[45%] max-w-[600px]`。
    3.  **增加留白**：调整消息列表底部的 `pb-32` 为 `pb-40`，防止输入框遮挡。

### Step 2: 重构会话重置逻辑 (Core Logic)
- **目标**：实现真正的“一键重启”。
- **行动**：
    1.  **修改 `handleReset`**：在 `ChatInterface.tsx` 中，点击重置按钮时同步执行：
        - `setMessages([])` (清空对话)
        - `resetCanvas(currentAgentId)` (清空画布)
        - `setSessionId(uuidv4())` (生成新会话 ID)
    2.  **添加反馈**：(可选) 简单的 console log 或状态变更确认。

### Step 3: 验证与验收
- **验收标准**：
    1.  对话中不再出现 JSON 代码块。
    2.  点击重置后，左侧清空，右侧变回“等待输入...”状态。
    3.  重新对话时，AI 能够重新引导，不受旧会话影响。
